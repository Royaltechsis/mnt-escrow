{"openapi":"3.1.0","info":{"title":"FastAPI","version":"0.1.0"},"paths":{"/api/escrow/get_all_transactions":{"get":{"tags":["escrow"],"summary":"Get Transaction History","operationId":"get_transaction_history_api_escrow_get_all_transactions_get","parameters":[{"name":"user_id","in":"query","required":true,"schema":{"title":"User Id"}},{"name":"actor","in":"query","required":true,"schema":{"title":"Actor"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/escrow/get_transaction":{"get":{"tags":["escrow"],"summary":"Get Transaction By Id","operationId":"get_transaction_by_id_api_escrow_get_transaction_get","parameters":[{"name":"escrow_transaction_id","in":"query","required":true,"schema":{"title":"Escrow Transaction Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/escrow/create_transaction":{"post":{"tags":["escrow"],"summary":"Create Transaction","operationId":"create_transaction_api_escrow_create_transaction_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionInstance"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/escrow/client_release_funds":{"post":{"tags":["escrow"],"summary":"Client Release Funds","operationId":"client_release_funds_api_escrow_client_release_funds_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReleaseFunds"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/escrow/client_confirm":{"post":{"tags":["escrow"],"summary":"Client Confirm Transaction","operationId":"client_confirm_transaction_api_escrow_client_confirm_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserConfirmation"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/escrow/merchant_confirm":{"post":{"tags":["escrow"],"summary":"Merchant Confirm Transaction","operationId":"merchant_confirm_transaction_api_escrow_merchant_confirm_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserConfirmation"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/escrow/update_transactions":{"put":{"tags":["escrow"],"summary":"Update Transactions","operationId":"update_transactions_api_escrow_update_transactions_put","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/escrow/merchant_release_funds":{"post":{"tags":["escrow"],"summary":"Merchant Release Funds","operationId":"merchant_release_funds_api_escrow_merchant_release_funds_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReleaseFunds"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/escrow/cancel_transaction":{"delete":{"tags":["escrow"],"summary":"Cancel Transaction","operationId":"cancel_transaction_api_escrow_cancel_transaction_delete","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/paystack/webhook":{"post":{"tags":["paystack"],"summary":"Paystack Webhook Handler","operationId":"paystack_webhook_handler_api_paystack_webhook_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/wallet/create":{"post":{"tags":["wallet"],"summary":"Create Wallet","operationId":"create_wallet_api_wallet_create_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WalletRequestDTO"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/wallet/fund":{"post":{"tags":["wallet"],"summary":"Initialize Payment","operationId":"initialize_payment_api_wallet_fund_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/wallet/withdraw":{"post":{"tags":["wallet"],"summary":"Withdraw Funds","description":"Improved withdraw endpoint behavior:\n- Idempotency by reference_code\n- Create PENDING txn and commit before calling Paystack\n- Store transfer/reference returned from initiate_transfer\n- Update txn status to PROCESSING after initiating transfer\n- Send a \"request received\" email immediately (not \"approved\")\n- All final success/failure handling is done via webhook handler","operationId":"withdraw_funds_api_wallet_withdraw_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionRequestDTO"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/wallet/balance":{"get":{"tags":["wallet"],"summary":"Get Balance","operationId":"get_balance_api_wallet_balance_get","parameters":[{"name":"user_id","in":"query","required":true,"schema":{"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/wallet/transaction_history":{"get":{"tags":["wallet"],"summary":"Transaction History","operationId":"transaction_history_api_wallet_transaction_history_get","parameters":[{"name":"user_id","in":"query","required":true,"schema":{"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/bank/withdrawal_account":{"post":{"tags":["bank"],"summary":"Add Withdrawal Account","operationId":"add_withdrawal_account_api_bank_withdrawal_account_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddWithdrawalBank"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["bank"],"summary":"Get Withdrawal Account By Id","operationId":"get_withdrawal_account_by_id_api_bank_withdrawal_account_get","parameters":[{"name":"withdrawal_account_id","in":"query","required":true,"schema":{"title":"Withdrawal Account Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["bank"],"summary":"Delete Withdrawal Account","operationId":"delete_withdrawal_account_api_bank_withdrawal_account_delete","parameters":[{"name":"withdrawal_account_id","in":"query","required":true,"schema":{"title":"Withdrawal Account Id"}}],"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/bank/get_withdrawal_account":{"get":{"tags":["bank"],"summary":"Get Withdrawal Accounts","operationId":"get_withdrawal_accounts_api_bank_get_withdrawal_account_get","parameters":[{"name":"user_id","in":"query","required":true,"schema":{"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/bank/get_all_accounts":{"get":{"tags":["bank"],"summary":"Get All Banks","operationId":"get_all_banks_api_bank_get_all_accounts_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/bank/confirm_withdrawal_account":{"post":{"tags":["bank"],"summary":"Confirm Withdrawal Account","operationId":"confirm_withdrawal_account_api_bank_confirm_withdrawal_account_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddWithdrawalBank"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/escrow/get_all_transactions":{"get":{"tags":["admin","escrow"],"summary":"Get All Transactions","operationId":"get_all_transactions_api_admin_escrow_get_all_transactions_get","parameters":[{"name":"args","in":"query","required":true,"schema":{"title":"Args"}},{"name":"kwargs","in":"query","required":true,"schema":{"title":"Kwargs"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/escrow/get_escrow_by_id":{"get":{"tags":["admin","escrow"],"summary":"Get Escrow By Id","operationId":"get_escrow_by_id_api_admin_escrow_get_escrow_by_id_get","parameters":[{"name":"escrow_id","in":"query","required":true,"schema":{"type":"string","description":"The ID of the escrow transaction to retrieve","title":"Escrow Id"},"description":"The ID of the escrow transaction to retrieve"},{"name":"args","in":"query","required":true,"schema":{"title":"Args"}},{"name":"kwargs","in":"query","required":true,"schema":{"title":"Kwargs"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EscrowResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/escrow/cancel_transaction":{"post":{"tags":["admin","escrow"],"summary":"Cancel Transaction","operationId":"cancel_transaction_api_admin_escrow_cancel_transaction_post","parameters":[{"name":"args","in":"query","required":true,"schema":{"title":"Args"}},{"name":"kwargs","in":"query","required":true,"schema":{"title":"Kwargs"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/escrow/dispute_transaction":{"post":{"tags":["admin","escrow"],"summary":"Dispute Transaction","operationId":"dispute_transaction_api_admin_escrow_dispute_transaction_post","parameters":[{"name":"escrow_id","in":"query","required":true,"schema":{"type":"string","title":"Escrow Id"}},{"name":"reason","in":"query","required":true,"schema":{"type":"string","title":"Reason"}},{"name":"args","in":"query","required":true,"schema":{"title":"Args"}},{"name":"kwargs","in":"query","required":true,"schema":{"title":"Kwargs"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/escrow/get_all_disputed_transactions":{"get":{"tags":["admin","escrow"],"summary":"Get All Disputed Transactions","operationId":"get_all_disputed_transactions_api_admin_escrow_get_all_disputed_transactions_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/escrow/force_release_funds":{"post":{"tags":["admin","escrow"],"summary":"Force Release Funds","operationId":"force_release_funds_api_admin_escrow_force_release_funds_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReleaseFunds"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/escrow/force_return_funds":{"post":{"tags":["admin","escrow"],"summary":"Force Return Funds","operationId":"force_return_funds_api_admin_escrow_force_return_funds_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReleaseFunds"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/escrow/resolve_dispute":{"post":{"tags":["admin","escrow"],"summary":"Resolve Dispute","operationId":"resolve_dispute_api_admin_escrow_resolve_dispute_post","parameters":[{"name":"escrow_id","in":"query","required":true,"schema":{"type":"string","title":"Escrow Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/wallet/credit":{"post":{"tags":["admin","wallet"],"summary":"Credit Wallet","operationId":"credit_wallet_api_admin_wallet_credit_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionRequestDTO"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/wallet/debit":{"post":{"tags":["admin","wallet"],"summary":"Debit Wallet","operationId":"debit_wallet_api_admin_wallet_debit_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionRequestDTO"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/wallet/get_transactions":{"get":{"tags":["admin","wallet"],"summary":"Get Wallet Transactions","operationId":"get_wallet_transactions_api_admin_wallet_get_transactions_get","parameters":[{"name":"user_id","in":"query","required":true,"schema":{"type":"string","description":"The ID of the user whose wallet transactions to retrieve","title":"User Id"},"description":"The ID of the user whose wallet transactions to retrieve"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/wallet/get_wallet":{"get":{"tags":["admin","wallet"],"summary":"Get Wallet By User Id","operationId":"get_wallet_by_user_id_api_admin_wallet_get_wallet_get","parameters":[{"name":"user_id","in":"query","required":true,"schema":{"type":"string","description":"The ID of the user whose wallet to retrieve","title":"User Id"},"description":"The ID of the user whose wallet to retrieve"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/wallet/freeze":{"post":{"tags":["admin","wallet"],"summary":"Freeze Wallet","operationId":"freeze_wallet_api_admin_wallet_freeze_post","parameters":[{"name":"user_id","in":"query","required":true,"schema":{"type":"string","description":"The ID of the user whose wallet to freeze","title":"User Id"},"description":"The ID of the user whose wallet to freeze"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/wallet/unfreeze":{"post":{"tags":["admin","wallet"],"summary":"Unfreeze Wallet","operationId":"unfreeze_wallet_api_admin_wallet_unfreeze_post","parameters":[{"name":"user_id","in":"query","required":true,"schema":{"type":"string","description":"The ID of the user whose wallet to unfreeze","title":"User Id"},"description":"The ID of the user whose wallet to unfreeze"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AddWithdrawalBank":{"properties":{"user_id":{"type":"string","title":"User Id"},"bank_code":{"type":"string","title":"Bank Code"},"bank_name":{"type":"string","title":"Bank Name"},"account_number":{"type":"string","title":"Account Number"},"account_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Account Name"}},"type":"object","required":["user_id","bank_code","bank_name","account_number"],"title":"AddWithdrawalBank"},"CancelRequest":{"properties":{"user_id":{"type":"string","title":"User Id"},"escrow_id":{"type":"string","title":"Escrow Id"}},"type":"object","required":["user_id","escrow_id"],"title":"CancelRequest"},"CurrencyCode":{"type":"string","enum":["NGN","USD","EUR","GBP"],"title":"CurrencyCode"},"EscrowResponse":{"properties":{"id":{"type":"string","title":"Id"},"client_id":{"type":"string","title":"Client Id"},"merchant_id":{"type":"string","title":"Merchant Id"},"client_agree":{"type":"boolean","title":"Client Agree"},"merchant_agree":{"type":"boolean","title":"Merchant Agree"},"amount":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Amount"},"status":{"title":"Status"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"finalized_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Finalized At"}},"type":"object","required":["id","client_id","merchant_id","client_agree","merchant_agree","amount","status","created_at"],"title":"EscrowResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"PaymentMetadata":{"properties":{"user_id":{"type":"string","title":"User Id"},"wallet_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Wallet Id"}},"type":"object","required":["user_id"],"title":"PaymentMetadata"},"PaymentRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"amount":{"type":"number","exclusiveMinimum":0.0,"title":"Amount"},"metadata":{"anyOf":[{"$ref":"#/components/schemas/PaymentMetadata"},{"type":"null"}]}},"type":"object","required":["email","amount"],"title":"PaymentRequest"},"ReleaseFunds":{"properties":{"escrow_id":{"type":"string","title":"Escrow Id"},"user_id":{"type":"string","title":"User Id"}},"type":"object","required":["escrow_id","user_id"],"title":"ReleaseFunds"},"TransactionInstance":{"properties":{"merchant_id":{"type":"string","title":"Merchant Id"},"client_id":{"type":"string","title":"Client Id"},"amount":{"type":"number","exclusiveMinimum":0.0,"title":"Amount"}},"type":"object","required":["merchant_id","client_id","amount"],"title":"TransactionInstance"},"TransactionRequestDTO":{"properties":{"user_id":{"type":"string","title":"User Id"},"email":{"type":"string","format":"email","title":"Email"},"currency":{"anyOf":[{"$ref":"#/components/schemas/CurrencyCode"},{"type":"null"}]},"amount":{"type":"number","exclusiveMinimum":100.0,"title":"Amount"},"transaction_type":{"anyOf":[{"$ref":"#/components/schemas/TransactionType"},{"type":"null"}]},"time":{"type":"string","format":"date-time","title":"Time"},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason"}},"type":"object","required":["user_id","email","currency","amount","transaction_type","time"],"title":"TransactionRequestDTO"},"TransactionType":{"type":"string","enum":["DEPOSIT","WITHDRAWAL","TRANSFER","ESCROW_FUND","ESCROW_RELEASE","REFUND","CREDIT"],"title":"TransactionType"},"UserConfirmation":{"properties":{"user_id":{"type":"string","title":"User Id"},"escrow_id":{"type":"string","title":"Escrow Id"},"confirm_status":{"type":"boolean","title":"Confirm Status","default":false}},"type":"object","required":["user_id","escrow_id"],"title":"UserConfirmation"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"WalletRequestDTO":{"properties":{"user_id":{"type":"string","title":"User Id"},"email":{"type":"string","format":"email","title":"Email"},"currency":{"anyOf":[{"$ref":"#/components/schemas/CurrencyCode"},{"type":"null"}]},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["user_id","email","currency","created_at"],"title":"WalletRequestDTO"}}}}